<!DOCTYPE html>
<html>

  <head>
    {% if page_title %}
    <title>{{ page_title }}</title>
    {% endif %}

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet" media="screen">
  </head>

  <body>
  <div id="page">

    <div id="sidebar">
      <div class="sidebarinfo">
        <img src="/static/images/character.jpg" alt="Sample" style="width:100px;height:100px;">
        <ul>
        <li>Name: {{ myHero.name}} </li>
        <li>Age: {{ myHero.age }}</li>
        <li>Experience: {{ myHero.current_exp }} / {{ myHero.max_exp }}</li>
        <li>Health: {{ myHero.current_health }} / {{ myHero.max_health }}</li></li>
        <li>Sanctity: {{ myHero.current_sanctity }} / {{ myHero.max_sanctity }}
        <li>Endurance: {{ myHero.current_endurance }} / {{ myHero.max_endurance }}</li>
        <li>Gold: {{ myHero.gold }}</li>
        </ul>
      </div>
      <div class="sidebarmenu">
        <ul>
        <li><a href=/home>Profile</a></li>
        <li><a href=/inventory_page>Inventory</a></li>
        {% if myHero.current_city %}
           <li><a href=/{{ myHero.current_city.location_type }}/{{ myHero.current_city.name }}>{{ myHero.current_city.name }}</a></li>
        {% else %}
          <li><a href=/{{ myHero.current_world.location_type }}/{{ myHero.current_world.name }}/{{ myHero.current_world.id }}>{{ myHero.current_world.location_type }}</a></li>
        {% endif %}
        <li><a href=/quest_log>Journal</a></li>
        <li><a href=/ability_tree/basic>Abilities</a></li>
        <li><a href=/admin>Admin</a></li>
        <li><a href=/under_construction>Users</a></li>
        <li><a href=/logout>Logout</a></li>
        <li><a href=/town/temporary_second_town>Second Town (temporary)</a></li>
        </ul>
      </div>
    </div>

{% if journal %}
  <div id="content">
     <div class="nav">
     <ul>
       <li><a href=/quest_log>Quests</a></li>
       <li><a href=/bestiary/default>Bestiary</a></li>
       <li><a href=/people_log/default>People</a></li>
       <li><a href=/map_log>Map</a></li>
       <li><a href=/achievement_log>Achievements</a></li>
     </ul>
    </div>
  </div>
{% endif %}

{% if ability_pages %}
  <div id="content">
     <div class="nav">
     <ul>
       <li><a href=/ability_tree/basic>Basic Skills</a></li>
       <li><a href=/ability_tree/archetype>Archetype Advancements</a></li>
       <li><a href=/ability_tree/class>Class Abilities</a></li>
       <li><a href=/ability_tree/religious>Religious Blessings</a></li>
     </ul>
    </div>
  </div>
{% endif %}

 <div id="content">

    {% if page_heading %}
    <h1>{{ page_heading }}</h1>
    {% endif %}

    {% if page_image %}
    <img src="/static/images/{{ page_image }}.jpg" alt="{{ page_image }}" style="width:304px;height:228px;">
    {% endif %}

    {% if paragraph %}
    <p>{{ paragraph }}</p>
    {% endif %}

    {% for text in conversation %}
    <br><b>{{ text[0] }}</b> {{ text[1] }}<br>
    {% endfor %}

    {% if move_on_the_map %}
      *Cave at 2 and City at 5*
      <h1>I am at {{ myHero.current_world.current_location.name }}</h1>
      {% for move in move_on_the_map %}
        <br><h1>MOVE TO <a href=/{{ myHero.current_world.location_type }}/{{ myHero.current_world.name }}/{{ move }}>{{ move }}</a></h1>
      {% endfor %}
    {% endif %}

    {% for status in status_display %}
      <h2>{{ status[2] }}</h2><b>{{ status[0] }}</b> {{ status[1] }}
    {% endfor %}

    {% if items_for_sale %}
      <h2>Here is our list of items:</h2>
      {% for item in items_for_sale %}
        {{ item.name }} ({{ item.buy_price }})
        <button class="command command-{{ item.buy_name }}" value="{{ item.buy_name }}">Buy</button><br>
      {% endfor %}        
    {% endif %}

    {% for link in page_links %}
    <h2>{{ link[0] }}<a href="{{ link[1] }}">{{ link[2] }}</a>{{ link[3] }}</h2>
    {% endfor %}

    {% for town_link in places_of_interest %}
      <h1>{{ town_link[2] }}</h1><h2><a href="{{ town_link[0] }}">{{ town_link[1] }}</a></h2>
    {% endfor %}

    {% if inventory_page %}
      <h1>Equipped:</h1>
      {% for item in myHero.equipped_items %} 
        {% if item.one_handed_weapon %}
          <h2>Right Hand:</h2>
          {{ item.name }} -- Durability: {{ item.durability }}/{{ item.durability }}{% if item.broken %}<font style="color:red">broken</font>{% endif %} &emsp;  <button class="command command-{{ item.name }}" value="{{ item.name }}">Unequip</button>   
        {% endif %}
        {% if item.shield %}
          <h2>Left Hand:</h2>
          {{ item.name }}-- Durability: {{ item.durability }}/{{ item.durability }}{% if item.broken %}<font style="color:red">broken</font>{% endif %} &emsp;  <button class="command command-{{ item.name }}" value="{{ item.name }}">Unequip</button>   
        {% endif %}
        {% if item.two_handed_weapon %}
          <h2>Both Hands:</h2>
          {{ item.name }}-- Durability: {{ item.durability }}/{{ item.max_durability }}{% if item.broken %}<font style="color:red">broken</font>{% endif %} &emsp;  <button class="command command-{{ item.name }}" value="{{ item.name }}">Unequip</button>   
        {% endif %}
        {% if item.chest_armour %}
          <h2>Shirt:</h2>
          {{ item.name }}-- Durability: {{ item.durability }}/{{ item.max_durability }}{% if item.broken %}<font style="color:red">broken</font>{% endif %} &emsp;  <button class="command command-{{ item.name }}" value="{{ item.name }}">Unequip</button>   
        {% endif %}
        {% if item.head_armour %}
          <h2>Helmet:</h2>
          {{ item.name }}-- Durability: {{ item.durability }}/{{ item.max_durability }}{% if item.broken %}<font style="color:red">broken</font>{% endif %} &emsp;  <button class="command command-{{ item.name }}" value="{{ item.name }}">Unequip</button>
        {% endif %}
        {% if item.leg_armour %}
          <h2>Pants:</h2>
          {{ item.name }}-- Durability: {{ item.durability }}/{{ item.max_durability }}{% if item.broken %}<font style="color:red">broken</font>{% endif %} &emsp;  <button class="command command-{{ item.name }}" value="{{ item.name }}">Unequip</button>
        {% endif %}
        {% if item.feet_armour %}
          <h2>Shoes:</h2>
          {{ item.name }}-- Durability: {{ item.durability }}/{{ item.max_durability }}{% if item.broken %}<font style="color:red">broken</font>{% endif %} &emsp;  <button class="command command-{{ item.name }}" value="{{ item.name }}">Unequip</button>
        {% endif %}
        {% if item.arm_armour %}
          <h2>Sleeves:</h2>
          {{ item.name }}-- Durability: {{ item.durability }}/{{ item.max_durability }}{% if item.broken %}<font style="color:red">broken</font>{% endif %} &emsp;  <button class="command command-{{ item.name }}" value="{{ item.name }}">Unequip</button>
        {% endif %}
        {% if item.hand_armour %}
          <h2>Gloves:</h2>
          {{ item.name }}-- Durability: {{ item.durability }}/{{ item.max_durability }}{% if item.broken %}<font style="color:red">broken</font>{% endif %} &emsp;  <button class="command command-{{ item.name }}" value="{{ item.name }}">Unequip</button>
        {% endif %}
        {% if item.ring %}
          <h2>Rings:</h2>
          {{ item.name }}-- Durability: {{ item.durability }}/{{ item.max_durability }}{% if item.broken %}<font style="color:red">broken</font>{% endif %} &emsp;  <button class="command command-{{ item.name }}" value="{{ item.name }}">Unequip</button>
        {% endif %}
      {% endfor %}
      <h1>Inventory:</h1>
      {% for item in myHero.inventory %}  
        <br>{% if not item.equippable %}{{ item.amount_owned }}{% endif %} {{ item.name }} {% if item.equippable %} -- Durability: {{ item.durability }}/{{ item.max_durability }}{% endif %}{% if item.broken %}<font style="color:red">broken</font>{% endif %} &emsp; 
        {% if item.equippable %} 
          <button class="command command-{{ item.name }}" value="{{ item.name }}">Equip</button>
        {% endif %}
        {% if item.consumable %}
          <button class="command command-{{ item.name }}" value="{{ item.name }}">Consume</button>
        {% endif %}
      {% endfor %}
    {% endif %}

    {% if ability_pages %}
*TESTING* Here are your known abilities:
{% for ability in myHero.abilities %}
<br><br>Ability(<b>{{ ability.ability_type }}</b>): {{ ability.name }}<br>Level: {{ability.level }}/{{ ability.max_level }}
{% endfor %}
<br>Ability Points: {{ myHero.ability_points }}
      <h1 style="text-align:center;">Abilities</h1>
      <h2 style="text-align:left;">Unknown</h2>
        {% for ability in unknown_abilities %}
          <button class="command command-{{ ability.name }}" value="{{ ability.name }}" title="{{ ability.name }} {{ ability.display_name }}: {{ ability.description }}">{{ ability.name }}</button><img src="/static/images/0.jpg" alt="?" style="width:25px;height:25px;"><br>
        {% endfor %}
      <h2 style="text-align:left;">Known</h2>
        {% for ability in learnable_abilities %}
          <button class="command command-{{ ability.name }}" value="{{ ability.name }}" title="{{ ability.name }} {{ ability.learn_name }}: {{ ability.description }}">{{ ability.name }}</button><img src="/static/images/{{ ability.display_name }}.jpg" alt="?" style="width:25px;height:25px;"><br>
        {% endfor %}
      <h2 style="text-align:left;">Mastered</h2>
        {% for ability in mastered_abilities %}
          <img src="/static/images/{{ ability.name }}.jpg"; height:70px; width:70px"><img src="/static/images/{{ ability.display_name }}.jpg" alt="?" style="width:25px;height:25px;"><br>
        {% endfor %}
    {% endif %}

    {% if primary_attributes %}
      <form method="post" action="" autocomplete="off">
      {% for attribute in primary_attributes %}
        <label for="name">{{ attribute[0] }}: {{ attribute[1] }}</label>
        <input type="number" name="{{ attribute[0] }}" min="0" max="{{ myHero.attribute_points }}" title="Numbers only" value="0"><br>
      {% endfor %}
    <input class="btn btn-default" type="submit" value="Submit">
    <h1>&emsp; &emsp; &emsp; &emsp; <b>Points remaining {{ myHero.attribute_points }}</b></h1>
      </form>
    {% endif %}

    {% if tavern %}
      <form action="" method="post">
	I would like to
        <select name="tavern_choice">
        {% for key,value in dialogue_options.items() %}
	<option value={{ key }}>{{ value }}</option>
        {% endfor %}
	</select>
      <input class="btn btn-default" type="submit" value="Next">
      </form>
    {% endif %}

    {% if quest_log %}
      <h1>Current Quests</h1>
      {% if current_quests %}
        {% for quest in current_quests %}
          <h2><br><b>{{ quest[0] }}</b> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Stage: {{ quest[2] }})</h2>
          {{ quest[1] }}
        {% endfor %}
      {% else %}
        No current quests.
      {% endif %}
      <h1>Current Errands</h1>
      {% if errands %}
        {% for errand in errands %}
          <br><b>{{ errand }}</b>
        {% endfor %}
      {% else %}
        No current errands.
      {% endif %}
      <h1>Completed Quests</h1>
      {% if completed_quests %}
        {% for quest in completed_quests %}
          <br><b>{{ quest }}</b><br>
          {{ paragraph }}
        {% endfor %}
      {% else %}
        No completed quests.
      {% endif %}
    {% endif %}

    {% if bestiary %}
      <div class="rightside">
        {% for monster in myHero.bestiary %}
          <ul>
            <li><a href=/bestiary/{{ monster.monster_id }}>{{ monster.name }}</a></li>
          </ul>
        {% endfor %}
    </div>
      <h1 style="text-align:center;">Bestiary</h1>
        {% if current_monster %}
          <h2>Entry:</h2><br>
          Name: {{ current_monster.name }}<br><br>
          Age: {{ current_monster.level }}<br><br>
          Type: {{ current_monster.species }} <br><br>
          <img src="/static/images/{{ current_monster.monster_id }}_display_picture.jpg" alt="{{ current_monster.name }} Picture" style="width:125px;height:125px;">
        {% else %}
          Here is a list of all of the beasts you have encountered!
        {% endif %}
    {% endif %}

    {% if people_log %}
      <div class="rightside">
        {% for npc in npc_data %}
          <ul>
            <li><a href=/people_log/{{ npc.npc_id }}>{{ npc.name }}</a></li>
          </ul>
        {% endfor %}
    </div>
      <h1 style="text-align:center;">People Log</h1>
        {% if current_npc %}
          <h2>Entry:</h2><br>
          Name: {{ current_npc.name }}<br><br>
          Age: {{ current_npc.age }}<br><br>
          Race: {{ current_npc.race }}
        {% else %}
          Here is a list of all of the notable people you have encountered!
        {% endif %}
    {% endif %}

    {% if achievement_log%}
      <h1>Achievements</h1>
      {% if completed_achievements %}
        {% for achievement in completed_achievements %}
          <h2><br><b>{{ achievement[0] }}  &nbsp; &nbsp; &nbsp; (+{{ achievement[1] }} experience)</b></h2>
        {% endfor %}
      {% else %}
        No completed achievements.
      {% endif %}
      <h1>All Achievements</h1>
      {% for achievement in kill_achievements %}
          <h2><br><b>{{ achievement[0] }}</b></h2>
      {% endfor %}
      <h1> Current Kill Statistics </h1> 
         {% for key, value in myHero.kill_quests.items() %}
              {{ key }}: {{ value }}<br>
         {% endfor %}
    {% endif %}
	
	{% if admin %}
      <form method="post" action="" autocomplete="off">
      {% for attribute in admin %}
        <label for="name">{{ attribute[0] }}: {{ attribute[1] }}</label>
        <input type="number" name="{{ attribute[0] }}" min="0" title="Numbers only" value=5><br>
      {% endfor %}
    <input class="btn btn-default" type="submit" value="Save">
      </form>
<h1 style="text-align:center;">Hidden Attributes</h1>
Experience Modifier: {{ myHero.experience_gain_modifier }}<br>
Gold Modifier: {{ myHero.gold_gain_modifier }}<br>
    {% endif %}

    {% for link in bottom_page_links %}
    <h2>{{ link[0] }}<a href="{{ link[1] }}">{{ link[2] }}</a>{{ link[3] }}</h2>
    {% endfor %}

	
	
{% if home %}
<p align="right"><a href="/reset_character">Reset Character</a></p>
<h1>General Statistics</h1>
<h2> 
Name: {{ myHero.character_name}}
<br>Age: {{ myHero.age }}
<br>Archetype: {{ myHero.archetype }}
<br>Specialization: {{ myHero.specialization }}
<br>Religion: {{ myHero.religion }}
<br>Experience: {{ myHero.current_exp }} / {{ myHero.max_exp }}
<br>Carrying Capacity: {{ myHero.current_carrying_capacity }} / {{ myHero.max_carrying_capacity }}
<br>Gold: {{ myHero.gold }}
<br>Endurance: {{ myHero.current_endurance }} / {{ myHero.max_endurance }}
</h2>


<h1>Battle Statistics</h1>
<table style="width:50%">
<tr>
<td><h2>Damage: {{ myHero.min_damage }} - {{ myHero.max_damage }}</td>
<td><h2>Health: {{ myHero.current_health }} / {{ myHero.max_health }}</h2></td>
</tr>
<tr>
<td><h2>Attack Speed: {{myHero.attack_speed }}</h2></td>
<td><h2>Accuracy: {{myHero.attack_accuracy }}%</h2></td>
</tr>
<tr>
<td><h2>Defence: {{ myHero.defence_modifier }}%</h2></td>
<td><h2>Evade: {{ myHero.evade_chance }}%</h2></td>
</tr>
<tr>
<td><h2>Critical Hit: {{ myHero.critical_hit }}%</h2></td>
<td><h2>First Strike: {{ myHero.first_strike }}%</h2></td>
</tr>
<tr>
<td><h2>Sanctity: {{ myHero.current_sanctity }} / {{ myHero.max_sanctity }}</h2></td>
<td><h2>Faith: {{ myHero.faith }}</h2></td>
</tr>
</table>

<h1>Attributes</h1>
<h2><title="Damage and carrying capacity">Strength</>: {{ myHero.strength }}
<br>Resilience: {{ myHero.resilience }}
<br>Vitality: {{ myHero.vitality }}
<br>Fortitude: {{ myHero.fortitude }}
<br>Reflexes: {{ myHero.reflexes }}
<br>Agility: {{ myHero.agility }}
<br>Perception: {{ myHero.perception }}
<br>Wisdom: {{ myHero.wisdom }}
<br>Divinity: {{ myHero.divinity }}
<br>Charisma: {{ myHero.charisma }}
<br>Survivalism: {{ myHero.survivalism }}
<br>Fortuity: {{ myHero.fortuity }}
</h2>
{% endif %}


<br>

      {% for message in get_flashed_messages() %}
        {{ message }}
      {% endfor %}
    </div>
  </body>
</html>

<script>
// Only run what comes next *after* the page has loaded
addEventListener("DOMContentLoaded", function() {
  // Grab all of the elements with a class of command
  // (which all of the buttons we just created have)
  var commandButtons = document.querySelectorAll(".command");
  for (var i=0, l=commandButtons.length; i<l; i++) {
    var button = commandButtons[i];
    // For each button, listen for the "click" event
    button.addEventListener("click", function(e) {
      // When a click happens, stop the button
      // from submitting our form (if we have one)
      e.preventDefault();

      var clickedButton = e.target;
      var command = clickedButton.value;

      // Now we need to send the data to our server
      // without reloading the page - this is the domain of
      // AJAX (Asynchronous JavaScript And XML)
      // We will create a new request object
      // and set up a handler for the response
      var request = new XMLHttpRequest();
      // We point the request at the appropriate command
      request.open("GET", "/" + command, true);
      // and then we send it off
      request.send();
	  location.reload();
	  
    });
  }
  
}, true);
</script>
