{% extends "layout.html" %}
{% block block1 %}

<script type="text/javascript">

// Validating Empty Field
function check_empty() {
if (document.getElementById('name').value == "" || document.getElementById('email').value == "" || document.getElementById('msg').value == "") {
alert("Fill All Fields !");
} else {
document.getElementById('form').submit();
alert("Form Submitted Successfully...");
}
}

//Function To Display Popup
function popupReplyBox(button, messageContent, messageSender) {
    document.getElementById('inboxPopupOuter').style.display = "block";
    document.getElementById('replyBoxMessageContent').innerHTML = messageContent;
    document.getElementById('replyBoxMessageSender').innerHTML = messageSender;
    document.getElementById("replyPopupBoxButton").setAttribute('data', messageSender);
}

//Function to Hide Popup
function div_hide(){
document.getElementById('inboxPopupOuter').style.display = "none";
}

</script>

<div class="inboxTopbar">
    <ul>
        {% if outbox %}
        <li><a href="/inbox/inbox">Inbox</a></li>
        <li><a class="topbarActive" href="/inbox/outbox">Outbox</a></li>
        {% else %}
        <li><a class="topbarActive" href="/inbox/inbox">Inbox</a></li>
        <li><a href="/inbox/outbox">Outbox</a></li>
        {% endif %}
    </ul>
</div>
<div style="clear: both;"></div>

<div id="inboxPopupOuter">
<!-- Popup Div Starts Here -->
<div id="inboxPopupInner">
<!-- Reply Popup Box Starts Here -->
<form action="#" id="inbox-form" method="post" name="form">
<img id="closeReplyBox" src="/static/images/closing_x.jpg" onclick ="div_hide()">
<h2>Reply</h2>
    <span id="replyBoxMessageContent"></span>
    <br>From <span id="replyBoxMessageSender"></span>
<hr>
<input class="inbox-input" id="inbox-form-inner" name="name" placeholder="Title..." type="text">
<input id="inbox-form-inner" name="email" placeholder="Response..." type="text">
<button id="replyPopupBoxButton" data="1" data-py-function="send_message_to_user_by_username">
    Send
</button>
</form>
</div>
<!-- Reply Popup Box Ends Here -->
</div>

{SELECT ALL} {DELETE}
<table id="inboxTable">
    <tr>
        <th></th>
        <th>From</th>
        <th>Message</th>
        <th>Timestamp</th>
        <th>ID</th>
    </tr>
    {% for message in hero.user.inbox.received_messages %}
        <tr>
            <td><img src="/static/images/empty_box.jpg" style="width:25px;height:25px;"></td>
            <td><a href=/display_users/see_user/{{ message.sender.user.username }}>{{ message.sender.user.username }}</a></td>
            <td>
                <!-- Button to Display Popup Button -->
                <button id="popup" data="{{ message.id }}" data-py-function="get_message_content_and_sender_by_id" data-js-callback="popupReplyBox">
                    {{ message.content[0:10] }}
                </button>
            </td>
            <td>{{ message.timestamp[0:10] }}</td>
            <td>{{ message.id }}</td>
        </tr>
    {% endfor %}
</table>
{% endblock %}
