<!-- This shows the admin page -->

{% extends "layout.html" %}

{% block nav_bar %}
<div class="topbar">
    <ul>
        <li><a {% if quest_log %}style="background-color:Red;"{% endif %} href=/quest_log>Quests</a></li>
        <li><a {% if bestiary %}style="background-color:Red;"{% endif %} href=/bestiary/0>Bestiary</a></li>
        <li><a {% if people_log %}style="background-color:Red;"{% endif %} href=/people_log/0>People</a></li>
        <li><a {% if map_log %}style="background-color:Red;"{% endif %} href=/map_log>Map</a></li>
        <li><a {% if achievement_log %}style="background-color:Red;"{% endif %} href=/quest_log>Achievements</a></li>
    </ul>
</div>
{% endblock %}

{% block block1 %}
<!-- This shows the quest log within the journal -->
<h1 style="text-align:center;">{{ page_title }}</h1>
<div style="clear:both"></div>
{% if quest_log %}
    <div>
        <div class="leftPageHalf" style="width:65%;">
            <h2>Current Quests</h2>
            {% for path in hero.journal.quest_paths if not path.completed %}
                <button class="genericAccordion" data-py-function="change_path_tooltip" data="{{ path.description }}" data-js-callback="questTooltip">{{ path.name.title() }} (Progress: {{ path.stage+1 }} / {{ path.stages }})</button>
                <div class="genericAccordionPanel">
                    <ul>
                        {% for i in range(path.stage + 1) %} <!-- This sgithould iterate over all completed+current stages, but not stages you haven't reached yet -->
                        {% set quest = path.quests[i] %}
                                <li>
                                    <button class="genericTooltipTrigger" data-py-function="change_quest_tooltip" data="{{ quest.id }}" data-js-callback="questTooltip">
                                        {{ quest.name }} (Stage: {{ i+1 }})
                                    </button>
                                </li>
                        {% endfor %}
                    </ul>
                </div>
            {% endfor %}
            <h2>Completed Quests</h2>
            {% for path in hero.journal.quest_paths if path.completed %}
                <button class="genericAccordion" data-py-function="change_path_tooltip" data="{{ path.description }}" data-js-callback="questTooltip">{{ path.name.title() }} (Progress: {{ path.stage+1 }} / {{ path.stages }})</button>
                <div class="genericAccordionPanel">
                    <ul>
                        {% for quest in path.quests %} <!-- This should iterate over all completed+current stages, but not stages you haven't reached yet -->

                                <li>
                                    <button class="genericTooltipTrigger" data-py-function="change_quest_tooltip" data="{{ quest.id }}" data-js-callback="questTooltip">
                                        {{ quest.name }} (Stage: {{ loop.index }})
                                    </button>
                                </li>
                        {% endfor %}
                    </ul>
                </div>
            {% endfor %}
        </div>
        <div class="genericTooltip">
            <div><span id="questTooltip">Click on a quest to see more information.</span></div>
            <div><span id="questReward"></span></div>
        </div>
    </div>

{% elif bestiary %}
    <div style="float:left;width:75%;">
        {% if display_monster %}
            <h2>Entry:</h2>
            <ul>
                <li>Name: {{ display_monster.name }}</li>>
                <li>Age: {{ display_monster.level }}</li>>
                <li>Species: {{ display_monster.species }}</li>>
                <li>
                    <img src="/static/images/{{ display_monster.name }}_display_picture.jpg" alt="{{ display_monster.name }} Picture" style="width:125px;height:125px;">
                </li>
            </ul>
        {% else %}
            Here is a list of all of the beasts you have encountered. Click on any monster to see more information.
        {% endif %}
    </div>
    <div style="float:right;width:20%;">
        {% for monster in all_monsters %}
            <ul>
                <li><a href=/bestiary/{{ monster.id }}>{{ monster.name }}</a></li>
            </ul>
        {% endfor %}
    </div>

<!-- This shows the People Log within the journal-->
{% elif people_log %}
    <div>
        <div style="float:left;width:75%;">
            {% if display_npc %}
                <h2>Entry:</h2>
                <ul>
                    <li>Name: {{ display_npc.name }}</li>
                    <li>Age: {{ display_npc.age }}</li>
                    <li>Race: {{ display_npc.race }}</li>
                    <li>
                        <img src="/static/images/{{ display_npc.name }}_display_picture.jpg" alt="{{ display_npc.name }} Picture" style="width:125px;height:125px;">
                    </li>
                </ul>
            {% else %}
                Here is a list of all of the notable people you have encountered. Click on any person to see more information.
            {% endif %}
        </div>
        <div style="float:right;width:20%;">
            {% for npc in all_npcs %}
                <ul>
                    <li><a href=/people_log/{{ npc.id }}>{{ npc.name }}</a></li>
                </ul>
            {% endfor %}
        </div>
    </div>

<!-- This shows the achievement log within the journal -->
{% elif achievement_log %}
<h1>Achievements</h1>
{% if completed_achievements %}
{% for achievement in completed_achievements %}
<h2><br><b>{{ achievement[0] }} &nbsp; &nbsp; &nbsp; (+{{ achievement[1] }} experience)</b></h2>
{% endfor %}
{% else %}
No completed achievements.
{% endif %}
<h1>All Achievements</h1>
{% for achievement in kill_achievements %}
<h2><br><b>{{ achievement[0] }}</b></h2>
{% endfor %}
<h1> Current Kill Statistics </h1>
{% for key, value in hero.kill_quests.items() %}
{{ key }}: {{ value }}<br>
{% endfor %}

<!-- This shows the map log within the journal -->
{% elif map_log %}
<h1>Maps</h1>
{% for map in hero.known_locations %}
{{ map }}
{% endfor %}
{% endif %}

<!-- I don't know why this needs to be below my code and not above it -->
<script>
var allProfs = document.getElementsByClassName("genericAccordion");
var index;
for (index = 0; index < allProfs.length; index++) {
    allProfs[index].addEventListener("click", function() {
        this.classList.toggle("active");
        var panel = this.nextElementSibling;
        if (panel.style.display === "block") {
            panel.style.display = "none";
        } else {
            panel.style.display = "block";
        }
    });
}
</script>

{% endblock %}

