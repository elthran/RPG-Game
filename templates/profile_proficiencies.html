{% extends "profile_template.html" %}
{% block block1 %}{% set hero = myHero %}
<!-- Basic Skill Page -->
<h1 style="text-align:center;">Proficiencies</h1>
<div class="stickyPointsRemainingBar">Points Remaining: <div style="display: inline" id="points_remaining">{{ myHero.proficiency_points }}</div></div>
<div style="clear: both;"></div>
<div>
	<div class="leftPageHalf" style="width:65%;">
        {% for attribute in all_proficiencies %}
            <button class="proficiencyAccordion">{{ attribute.name }} (Current level: {{ attribute.level }})</button>
            <div class="proficiencyAccordionPanel">
                <ul>
                    {% for proficiency in myHero.proficiencies %}
                        {% if proficiency.attribute_type == attribute.name %}
                            <li>
                                <button class="proficiencyTooltipTrigger" data-py-function="change_proficiency_tooltip" data="{{ proficiency.id }}" data-js-callback="proficiencyTooltip">
                                    {{ proficiency.name}} (Current Level: <div style="display: inline" id="proficiency-{{ proficiency.id }}">{{ proficiency.level }}</div>)
                                    <button data-py-function="update_proficiency" data="{{ proficiency.id }}" id="proficiencyButton" data-js-callback="updateProf" {% if myHero.proficiency_points <= 0 or proficiency.is_max_level() %}style="display: none"{% endif %}>
                                    </button>
                                </button>
                                </li>
                        {% endif %}
                    {% endfor %}
                </ul>
            </div>
        {% endfor %}
    </div>
    <div class="proficiencyTooltip">
            <span id="proficiencyTooltip">Click on a proficiency to see more information.</span>
    </div>
</div>

<script>
var allProfs = document.getElementsByClassName("proficiencyAccordion");
var index;
for (index = 0; index < allProfs.length; index++) {
    allProfs[index].addEventListener("click", function() {
        this.classList.toggle("active");
        var panel = this.nextElementSibling;
        if (panel.style.display === "block") {
            panel.style.display = "none";
        } else {
            panel.style.display = "block";
        }
    });
}
</script>

<!-- Below here is the old code. It can be deleted. -->

<div style="clear: both;"></div>
<div class="proficiencyPage">
    <div class="proficiencyPageInner">
        {% for attribute in profs1 %}
            <h1>
                <center>{{ attribute.name }}: {{attribute.level }}</center>
            </h1>
            {% for proficiency in myHero.proficiencies %}
                {% if proficiency.attribute_type == attribute.name %}
                    <div class="tooltip">
                        <ul>
                            {{ proficiency.name}}:
                            <div style="display: inline" id="proficiency-{{ proficiency.id }}">{{ proficiency.level }}</div>
                            <span id="tooltipPopup-{{ proficiency.id }}">
                                                {{ proficiency.description }}:
                                                {% set proficiency_tooltip = proficiency.tooltip.split(';') %}
                                                {% for tooltip in proficiency_tooltip %}
                                                    <br>&bull; {{ tooltip }}
                                                {% endfor %}
                                                <div style="display:
                                                {% if proficiency.is_max_level() %} inline{% else %} none
                                                {% endif %}"><br>{{ proficiency.error }}</div>
                                            </span>
                            <button data-py-function="update_proficiency" data="{{ proficiency.id }}"
                                    id="proficiencyButton"
                                    data-js-callback="updateProf" {% if myHero.proficiency_points <= 0 or proficiency.is_max_level() %} style="display: none"{% endif %}></button>
                        </ul>
                    </div>
                {% endif %}
            {% endfor %}
        {% endfor %}
    </div>
    <div class="proficiencyPageInner">
        {% for attribute in profs2 %}
        <h1>
            <center>{{ attribute.name }}: {{attribute.level }}</center>
        </h1>
        {% for proficiency in myHero.proficiencies %}
        {% if proficiency.attribute_type == attribute.name %}
        <div class="tooltip">
            <ul>
                {{ proficiency.name}}:
                <div style="display: inline" id="proficiency-{{ proficiency.id }}">{{ proficiency.level }}</div>
                <span id="tooltipPopup-{{ proficiency.id }}">
                                    {{ proficiency.description }}:
                                    {% set proficiency_tooltip = proficiency.tooltip.split(';') %}
                                    {% for tooltip in proficiency_tooltip %}
                                        <br>&bull; {{ tooltip }}
                                    {% endfor %}
                                    <div style="display:
                                    {% if proficiency.is_max_level() %} inline{% else %} none
                                    {% endif %}"><br>{{ proficiency.error }}</div>
                                </span>
                <button data-py-function="update_proficiency"
                        data="{{ proficiency.id }}" id="proficiencyButton"
                        data-js-callback="updateProf" {% if
                        myHero.proficiency_points
                <= 0 or proficiency.is_max_level() %} style="display: none"{% endif %}></button>
            </ul>
        </div>
        {% endif %}
        {% endfor %}
        {% endfor %}
    </div>
    <div class="proficiencyPageInner">
        {% for attribute in profs3 %}
        <h1>
            <center>{{ attribute.name }}: {{attribute.level }}</center>
        </h1>
        {% for proficiency in myHero.proficiencies %}
        {% if proficiency.attribute_type == attribute.name %}
        <div class="tooltip">
            <ul>
                {{ proficiency.name}}:
                <div style="display: inline" id="proficiency-{{ proficiency.id }}">{{ proficiency.level }}</div>
                <span id="tooltipPopup-{{ proficiency.id }}">
                                    {{ proficiency.description }}:
                                    {% set proficiency_tooltip = proficiency.tooltip.split(';') %}
                                    {% for tooltip in proficiency_tooltip %}
                                        <br>&bull; {{ tooltip }}
                                    {% endfor %}
                                    <div style="display:
                                    {% if proficiency.is_max_level() %} inline{% else %} none
                                    {% endif %}"><br>{{ proficiency.error }}</div>
                                </span>
                <button data-py-function="update_proficiency"
                        data="{{ proficiency.id }}" id="proficiencyButton"
                        data-js-callback="updateProf" {% if
                        myHero.proficiency_points
                <= 0 or proficiency.is_max_level() %} style="display: none"{% endif %}></button>
            </ul>
        </div>
        {% endif %}
        {% endfor %}
        {% endfor %}
    </div>
</div>
<div style="clear: both;"></div>

{% endblock %}
