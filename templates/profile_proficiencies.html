{% extends "profile_template.html" %}
{% block block1 %}{% set hero = myHero %}
<!-- Basic Skill Page -->
<h1 style="text-align:center;">Proficiencies</h1>
<div class="stickyPointsRemainingBar">Points Remaining: <div style="display: inline" id="points_remaining">{{ myHero.proficiency_points }}</div></div>
<div style="clear: both;"></div>
<div>
	<div class="leftPageHalf" style="width:65%;">
        {% for attribute in all_attributes %}
            <button class="proficiencyAccordion">{{ attribute.name }} (Current level: {{ attribute.level }})</button>
            <div class="proficiencyAccordionPanel">
                <ul>
                    {% for proficiency in myHero.proficiencies %}
                        {% if proficiency.attribute_type == attribute.name %}
                            <li>
                                <button class="proficiencyTooltipTrigger" data-py-function="change_proficiency_tooltip" data="{{ proficiency.id }}" data-js-callback="proficiencyTooltip">
                                    {{ proficiency.name}} (Current Level: <div style="display: inline" id="proficiency-{{ proficiency.id }}">{{ proficiency.level }}</div>)
                                    <button class="upgradeButton" data-py-function="update_proficiency" data="{{ proficiency.id }}" id="proficiencyButton" data-js-callback="updateProficiency" {% if myHero.proficiency_points <= 0 or proficiency.is_max_level() %}style="display: none"{% endif %}>
                                    </button>
                                </button>
                                </li>
                        {% endif %}
                    {% endfor %}
                </ul>
            </div>
        {% endfor %}
    </div>
    <div class="proficiencyTooltip">
            <span id="proficiencyTooltip">Click on a proficiency to see more information.</span>
    </div>
</div>

<!-- I don't know why this needs to be below my code and not above it -->
<script>
var allProfs = document.getElementsByClassName("proficiencyAccordion");
var index;
for (index = 0; index < allProfs.length; index++) {
    allProfs[index].addEventListener("click", function() {
        this.classList.toggle("active");
        var panel = this.nextElementSibling;
        if (panel.style.display === "block") {
            panel.style.display = "none";
        } else {
            panel.style.display = "block";
        }
    });
}
</script>

{% endblock %}
